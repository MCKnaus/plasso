<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michael Knaus" />
<meta name="author" content="Stefan Glaisner" />

<meta name="date" content="2023-07-24" />

<title>An introduction to plasso</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<style type="text/css">detaiks.chunk-details > summary.chunk-summary {
text-align: right;
}
details.chunk-details[open] > summary.chunk-summary::after {
content: "Hide";
}
details.chunk-details[open] > summary.chunk-summary > span.chunk-summary-text {
display: none;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">An introduction to plasso</h1>
<h4 class="author">Michael Knaus</h4>
<h4 class="author">Stefan Glaisner</h4>
<h4 class="date">July 24, 2023</h4>


<div id="TOC">
<ul>
<li><a href="#getting-started" id="toc-getting-started">Getting
started</a></li>
<li><a href="#plasso" id="toc-plasso">plasso</a></li>
<li><a href="#cv.plasso" id="toc-cv.plasso">cv.plasso</a></li>
</ul>
</div>

<p>This notebook provides a detailed overview over the
<code>plasso</code> package and its two main functions
<code>plasso</code> and <code>cv.plasso</code> which were developed in
the course of <span class="citation">Knaus (<a href="#ref-knaus">2022</a>)</span>. This package is strongly oriented
around the <code>glmnet</code> package and rests on its standard
function <code>glmnet</code> in its very basis. Related theory and
algorithms are described in <span class="citation">Friedman, Hastie, and
Tibshirani (<a href="#ref-glmnet">2010</a>)</span>.</p>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<p>Make sure that you install the package from its <a href="https://github.com/stefan-1997/plasso">Github page</a>. For the
installation you will need the <code>devtools</code> package. General
dependencies are: <code>glmnet</code>, <code>Matrix</code>,
<code>methods</code>, <code>parallel</code>, <code>doParallel</code>,
<code>foreach</code> and <code>iterators</code>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;stefan-1997/plasso&quot;</span>)</span></code></pre></div>
</details>
<p>Then, <code>plasso</code> can be loaded via the standard
<code>library</code> function.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(plasso)</span></code></pre></div>
</details>
<p>The package generally provides two functions <code>plasso</code> and
<code>cv.plasso</code> which are both built on top of the
<code>glmnet</code> functionality. Specifically, a <code>glmnet</code>
object lives within both functions and also in their outputs (list item
<code>lasso_full</code>).</p>
<p>The term <code>plasso</code> refers to a Post-Lasso model which
estimates a least squares algorithm only for the active (i.e. non-zero)
coefficients of a previously estimated Lasso models. This follows the
idea that we want to do selection but without shrinkage.</p>
<p>The package comes with some simulated data representing the following
DGP:</p>
<p>The covariates matrix <span class="math inline">\(X\)</span> consists
of 25 variables whose effect size one the target <span class="math inline">\(Y\)</span> is defined by the vector <span class="math inline">\(\boldsymbol{\pi} = [1, 0.9, 0.8, ..., 0.1, 0, ...,
0]&#39;\)</span> where the first 10 effects decrease from 1 to 0.1 by
0.1 whereas the remaining ones are zero. The variables in <span class="math inline">\(X\)</span> follow a normal distribution with mean
zero while the covariance matrix follows a Toeplitz matrix, which is
characterized by having constant diagonals: <span class="math display">\[
\boldsymbol{\Sigma} = \begin{bmatrix} 1 &amp; 0.7 &amp; 0.7^2 &amp; ...
&amp; 0.7^{24} \\ 0.7 &amp; 1 &amp; 0.7 &amp; ... &amp; 0.7^{23} \\
0.7^2 &amp; 0.7 &amp; 1 &amp; ... &amp; 0.7^{22} \\ \vdots &amp; \vdots
&amp; \vdots &amp; \ddots &amp; \vdots \\ 0.7^{24} &amp; 0.7^{23} &amp;
0.7^{22} &amp; ... &amp; 1 \end{bmatrix}
\]</span></p>
<p>The target <span class="math inline">\(\boldsymbol{y}\)</span> is
then a linear transformation of <span class="math inline">\(\boldsymbol{X}\)</span> plus a vector of standard
normal random variables. Each element of <span class="math inline">\(\boldsymbol{y}\)</span> is given by: <span class="math display">\[
y_i = \boldsymbol{X}_i \boldsymbol{\pi} + \varepsilon_i
\]</span> where <span class="math inline">\(\varepsilon_i \sim
\mathcal{N}(0,4)\)</span>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">data</span>(toeplitz)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">as.matrix</span>(toeplitz[,<span class="dv">1</span>])</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>X <span class="ot">=</span> toeplitz[,<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
</details>
</div>
<div id="plasso" class="section level1">
<h1>plasso</h1>
<p><code>plasso</code> basically estimates least squares estimates for
all lambda values of a standard <code>glmnet</code> object. The
function’s standard output is comparable to the one of a simple
<code>glmnet</code> output.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>p <span class="ot">=</span> plasso<span class="sc">::</span><span class="fu">plasso</span>(X,y)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>p</span></code></pre></div>
</details>
<pre><code>## 
## Call:  plasso::plasso(x = X, y = y) 
## 
##    Df  %Dev  Lambda
## 1   0  0.00 2.92300
## 2   2  5.23 2.66300
## 3   2 10.30 2.42600
## 4   4 15.20 2.21100
## 5   4 19.79 2.01400
## 6   4 23.60 1.83500
....</code></pre>
<p>You can plot the coefficient paths for both the Post-Lasso model as
well as the underlying ‘original’ Lasso model.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">lasso=</span><span class="cn">FALSE</span>, <span class="at">xvar=</span><span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
</details>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">lasso=</span><span class="cn">TRUE</span>, <span class="at">xvar=</span><span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
</details>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can also have a look at which coefficients are active for a chosen
lambda value. Here, the difference between Post-Lasso and Lasso becomes
clearly visible. For the Lasso model, there is not only feature
selection but shrinkage which results in the active coefficients being
smaller than for the Post-Lasso model:</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>coef_p <span class="ot">=</span> <span class="fu">coef</span>(p, <span class="at">s=</span><span class="fl">0.01</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">as.vector</span>(coef_p<span class="sc">$</span>plasso)</span></code></pre></div>
</details>
<pre><code>##  [1]  0.22209056  1.13656782  0.68871232  0.92827081  0.56656235  0.80797359
##  [7]  0.42842293  0.45639347  0.42034140  0.00000000  0.16425432 -0.11781658
## [13]  0.10773322  0.00000000 -0.22430618  0.16551773  0.01300971  0.03357346
## [19] -0.08372784  0.00000000 -0.15004207 -0.07025858  0.13362126  0.24216127
## [25] -0.54792800  0.09223639</code></pre>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">as.vector</span>(coef_p<span class="sc">$</span>lasso)</span></code></pre></div>
</details>
<pre><code>##  [1]  0.221710668  1.126151911  0.684970311  0.931825349  0.569261080
##  [6]  0.803620047  0.424305816  0.455500178  0.418718079  0.000000000
## [11]  0.137857402 -0.064819943  0.057630665  0.000000000 -0.177498583
## [16]  0.133412676  0.014573190  0.000416591 -0.051852998  0.000000000
## [21] -0.143287852 -0.047109349  0.107263439  0.214044280 -0.487376622
## [26]  0.054743000</code></pre>
</div>
<div id="cv.plasso" class="section level1">
<h1>cv.plasso</h1>
<p>The <code>cv.plasso</code> function uses cross-validation to
determine the performance of different values for the
<code>lambda</code> penalty term for both models (Post-Lasso and Lasso).
The returned output of class <code>cv.plasso</code> includes the mean
squared errors.</p>
<p>When applying the <code>summary</code> method and setting the
<code>default</code> parameter as FALSE, we get some informative output
considering the optimal choice of lambda.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>p.cv <span class="ot">=</span> plasso<span class="sc">::</span><span class="fu">cv.plasso</span>(X,y,<span class="at">kf=</span><span class="dv">5</span>,<span class="at">parallel=</span><span class="cn">FALSE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">summary</span>(p.cv, <span class="at">default=</span><span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<pre><code>## 
## Call:
##  plasso::cv.plasso(x = X, y = y, kf = 5, parallel = FALSE)
## 
## Lasso:
##  Minimum CV MSE Lasso:  15.44
##  Lambda at minimum:  0.1236
##  Active variables at minimum:  (Intercept) X1 X2 X3 X4 X5 X6 X7 X8 X10 X20 X24
## Post-Lasso:
##  Minimum CV MSE Post-Lasso:  15.39
##  Lambda at minimum:  0.3134
##  Active variables at minimum:  (Intercept) X1 X2 X3 X4 X5 X6 X7 X8</code></pre>
<p>Plot the cross-validated MSE by Lambda value for both models.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">plot</span>(p.cv, <span class="at">legend_pos=</span><span class="st">&quot;left&quot;</span>, <span class="at">legend_size=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Plot the cross-validated MSE by Lambda value for both models.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>glm.cv <span class="ot">=</span> glmnet<span class="sc">::</span><span class="fu">cv.glmnet</span>(X,y)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">plot</span>(glm.cv)</span></code></pre></div>
</details>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can use the following code to get the value of the optimal
<code>lambda</code> (for the Post-Lasso model) and the coefficients at
that value of <span class="math inline">\(\lambda\)</span>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>p.cv<span class="sc">$</span>lambda_min_pl</span></code></pre></div>
</details>
<pre><code>## [1] 0.3133706</code></pre>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>coef_pcv <span class="ot">=</span> <span class="fu">coef</span>(p.cv, <span class="at">S=</span><span class="st">&quot;optimal&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">as.vector</span>(coef_pcv<span class="sc">$</span>plasso)</span></code></pre></div>
</details>
<pre><code>##  [1] 0.2216971 1.1452613 0.6541461 0.9633945 0.5920545 0.8030483 0.3960978
##  [8] 0.4751934 0.4702198 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
## [15] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
## [22] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</code></pre>
<p><br> <br></p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-glmnet" class="csl-entry">
Friedman, Jerome, Trevor Hastie, and Robert Tibshirani. 2010.
<span>“Regularization Paths for Generalized Linear Models via Coordinate
Descent.”</span> <em>Journal of Statistical Software, Articles</em> 33
(1): 1–22. <a href="https://doi.org/10.18637/jss.v033.i01">https://doi.org/10.18637/jss.v033.i01</a>.
</div>
<div id="ref-knaus" class="csl-entry">
Knaus, Michael C. 2022. <span>“<span class="nocase">Double machine
learning-based programme evaluation under
unconfoundedness</span>.”</span> <em>The Econometrics Journal</em> 25
(3): 602–27. <a href="https://doi.org/10.1093/ectj/utac015">https://doi.org/10.1093/ectj/utac015</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
