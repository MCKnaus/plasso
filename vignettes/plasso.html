<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michael Knaus" />
<meta name="author" content="Stefan Glaisner" />

<meta name="date" content="2023-08-23" />

<title>An introduction to plasso</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<style type="text/css">detaiks.chunk-details > summary.chunk-summary {
text-align: right;
}
details.chunk-details[open] > summary.chunk-summary::after {
content: "Hide";
}
details.chunk-details[open] > summary.chunk-summary > span.chunk-summary-text {
display: none;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">An introduction to plasso</h1>
<h4 class="author">Michael Knaus</h4>
<h4 class="author">Stefan Glaisner</h4>
<h4 class="date">August 23, 2023</h4>


<div id="TOC">
<ul>
<li><a href="#getting-started" id="toc-getting-started">Getting
started</a></li>
<li><a href="#plasso" id="toc-plasso">plasso</a></li>
<li><a href="#cv.plasso" id="toc-cv.plasso">cv.plasso</a></li>
</ul>
</div>

<p>This notebook provides a detailed overview over the
<code>plasso</code> package and its two main functions
<code>plasso</code> and <code>cv.plasso</code> which were developed in
the course of <span class="citation">Knaus (<a href="#ref-knaus">2022</a>)</span>. This package is strongly oriented
around the <code>glmnet</code> package and rests on its standard
function <code>glmnet</code> in its very basis. Related theory and
algorithms are described in <span class="citation">Friedman, Hastie, and
Tibshirani (<a href="#ref-glmnet">2010</a>)</span>.</p>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<p>The very latest version of the package can be installed from its <a href="https://github.com/stefan-1997/plasso">Github page</a>. For the
installation you will need the <code>devtools</code> package. The latest
‘official’ version can be installed from CRAN using
`install.packages()’. We recommend the latter.</p>
<p>General dependencies are: <code>glmnet</code>, <code>Matrix</code>,
<code>methods</code>, <code>parallel</code>, <code>doParallel</code>,
<code>foreach</code> and <code>iterators</code>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;stefan-1997/plasso&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;plasso&quot;</span>)</span></code></pre></div>
</details>
<p>Load <code>plasso</code> using <code>library()</code>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(plasso)</span></code></pre></div>
</details>
<p>The package generally provides two functions <code>plasso</code> and
<code>cv.plasso</code> which are both built on top of the
<code>glmnet</code> functionality. Specifically, a <code>glmnet</code>
object lives within both functions and also in their outputs (list item
<code>lasso_full</code>).</p>
<p>The term <code>plasso</code> refers to a Post-Lasso model which
estimates a least squares algorithm only for the active (i.e. non-zero)
coefficients of a previously estimated Lasso models. This follows the
idea that we want to do selection but without shrinkage.</p>
<p>The package comes with some simulated data representing the following
DGP:</p>
<p>The covariates matrix <span class="math inline">\(X\)</span> consists
of 10 variables whose effect size one the target <span class="math inline">\(Y\)</span> is defined by the vector <span class="math inline">\(\boldsymbol{\pi} = [1, -0.83, 0.67, -0.5, 0.33,
-0.17, 0, ..., 0]&#39;\)</span> where the first six effect sizes
decrease in absolute terms continuously from 1 to 0 and alternate in
their sign. The true causal effect of all other covariates is 0. The
variables in <span class="math inline">\(X\)</span> follow a normal
distribution with mean zero while the covariance matrix follows a
Toeplitz matrix, which is characterized by having constant diagonals:
<span class="math display">\[
\boldsymbol{\Sigma} = \begin{bmatrix} 1 &amp; 0.7 &amp; 0.7^2 &amp; ...
&amp; 0.7^{9} \\ 0.7 &amp; 1 &amp; 0.7 &amp; ... &amp; 0.7^{8} \\ 0.7^2
&amp; 0.7 &amp; 1 &amp; ... &amp; 0.7^{7} \\ \vdots &amp; \vdots &amp;
\vdots &amp; \ddots &amp; \vdots \\ 0.7^{9} &amp; 0.7^{8} &amp; 0.7^{7}
&amp; ... &amp; 1 \end{bmatrix}
\]</span></p>
<p>The target <span class="math inline">\(\boldsymbol{y}\)</span> is
then a linear transformation of <span class="math inline">\(\boldsymbol{X}\)</span> plus a vector of standard
normal random variables. Each element of <span class="math inline">\(\boldsymbol{y}\)</span> is given by: <span class="math display">\[
y_i = \boldsymbol{X}_i \boldsymbol{\pi} + \varepsilon_i
\]</span> where <span class="math inline">\(\varepsilon_i \sim
\mathcal{N}(0,4)\)</span>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">data</span>(toeplitz)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">as.matrix</span>(toeplitz[,<span class="dv">1</span>])</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>X <span class="ot">=</span> toeplitz[,<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
</details>
</div>
<div id="plasso" class="section level1">
<h1>plasso</h1>
<p><code>plasso</code> returns least squares estimates for all lambda
values of a standard <code>glmnet</code> object for both a simple Lasso
and a Post-Lasso model.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>p <span class="ot">=</span> plasso<span class="sc">::</span><span class="fu">plasso</span>(X,y)</span></code></pre></div>
</details>
<p>You can plot the coefficient paths for both the Post-Lasso model as
well as the underlying ‘original’ Lasso model. This nicely illustrates
the difference between the Lasso and Post-Lasso models where the latter
is characterized by jumps in its coefficient paths every time a new
variable enters the active set.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">lasso=</span><span class="cn">FALSE</span>, <span class="at">xvar=</span><span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
</details>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">lasso=</span><span class="cn">TRUE</span>, <span class="at">xvar=</span><span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
</details>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can also have a look at which coefficients are active for a chosen
lambda value. Here, the difference between Post-Lasso and Lasso becomes
clearly visible. For the Lasso model, there is not only feature
selection but shrinkage which results in the active coefficients being
smaller than for the Post-Lasso model:</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>coef_p <span class="ot">=</span> <span class="fu">coef</span>(p, <span class="at">s=</span><span class="fl">0.01</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">as.vector</span>(coef_p<span class="sc">$</span>plasso)</span></code></pre></div>
</details>
<pre><code>##  [1]  0.1438137  1.0187628 -0.6214926  0.4673645 -0.2300834 -0.3575276
##  [7]  0.2180390  0.1180676 -0.2138268  0.1975462 -0.1047983</code></pre>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">as.vector</span>(coef_p<span class="sc">$</span>lasso)</span></code></pre></div>
</details>
<pre><code>##  [1]  0.14498611  0.98729386 -0.56374511  0.40656768 -0.20023679 -0.33156564
##  [7]  0.18985685  0.08930237 -0.16087044  0.13798825 -0.06639638</code></pre>
</div>
<div id="cv.plasso" class="section level1">
<h1>cv.plasso</h1>
<p>The <code>cv.plasso</code> function uses cross-validation to
determine the performance of different values for the
<code>lambda</code> penalty term for both models (Post-Lasso and Lasso).
The returned output of class <code>cv.plasso</code> includes the mean
squared errors.</p>
<p>When applying the <code>summary</code> method and setting the
<code>default</code> parameter as FALSE, you can get some informative
output considering the optimal choice of lambda.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>p.cv <span class="ot">=</span> plasso<span class="sc">::</span><span class="fu">cv.plasso</span>(X,y,<span class="at">kf=</span><span class="dv">5</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">summary</span>(p.cv, <span class="at">default=</span><span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<pre><code>## 
## Call:
##  plasso::cv.plasso(x = X, y = y, kf = 5)
## 
## Lasso:
##  Minimum CV MSE Lasso:  15.33
##  Lambda at minimum:  0.1439
##  Active variables at minimum:  (Intercept) X1 X5
## Post-Lasso:
##  Minimum CV MSE Post-Lasso:  15.32
##  Lambda at minimum:  0.2291
##  Active variables at minimum:  (Intercept) X1 X5</code></pre>
<p>Using the <code>plot</code> method extends the basic
<code>glmnet</code> visualization by the cross-validated MSEs for the
Post-Lasso model.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(p.cv, <span class="at">legend_pos=</span><span class="st">&quot;left&quot;</span>, <span class="at">legend_size=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can use the following code to get the optimal lambda value (for
the Post-Lasso model here) and the associated coefficients at that value
of <span class="math inline">\(\lambda\)</span>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>p.cv<span class="sc">$</span>lambda_min_pl</span></code></pre></div>
</details>
<pre><code>## [1] 0.2290796</code></pre>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>coef_pcv <span class="ot">=</span> <span class="fu">coef</span>(p.cv, <span class="at">S=</span><span class="st">&quot;optimal&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">as.vector</span>(coef_pcv<span class="sc">$</span>plasso)</span></code></pre></div>
</details>
<pre><code>##  [1]  0.1410181  0.7663423  0.0000000  0.0000000  0.0000000 -0.3000942
##  [7]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</code></pre>
<p><br> <br></p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-glmnet" class="csl-entry">
Friedman, Jerome, Trevor Hastie, and Robert Tibshirani. 2010.
<span>“Regularization Paths for Generalized Linear Models via Coordinate
Descent.”</span> <em>Journal of Statistical Software</em> 33 (1): 1–22.
<a href="https://doi.org/10.18637/jss.v033.i01">https://doi.org/10.18637/jss.v033.i01</a>.
</div>
<div id="ref-knaus" class="csl-entry">
Knaus, Michael C. 2022. <span>“<span class="nocase">Double machine
learning-based programme evaluation under
unconfoundedness</span>.”</span> <em>The Econometrics Journal</em> 25
(3): 602–27. <a href="https://doi.org/10.1093/ectj/utac015">https://doi.org/10.1093/ectj/utac015</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
